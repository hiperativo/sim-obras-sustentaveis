class Construction < ActiveRecord::Base
	# serialize :dados, Hash
	attr_accessible :dados
	COLUNAS=[ 
		:codigo_obra,
		:nome_da_obra,
		:tipo_de_logradouro,
		:logradouro,
		:bairro,
		:cep,
		:estado,
		:cidade,
		:contato1_nome,
		:contato1_telefone,
		:contato1_email,
		:contato1_razao_social,
		:contato1_funcao,
		:contato2_nome,
		:contato2_telefone,
		:contato2_email,
		:contato2_razao_social,
		:contato2_funcao,
		:contato3_nome,
		:contato3_telefone,
		:contato3_email,
		:contato3_razao_social,
		:contato3_funcao,
		:contato4_nome,
		:contato4_telefone,
		:contato4_email,
		:contato4_razao_social,
		:contato4_funcao,
		:contato5_nome,
		:contato5_telefone,
		:contato5_email,
		:contato5_razao_social,
		:contato5_funcao,
		:m2_unidade,
		:m2_util_total,
		:numero_de_unidades,
		:numero_de_andares,
		:estrutura_utilizada,
		:laje_utilizada,
		:inicio_da_obra,
		:termino_da_obra,
		:projeto,
		:lancamento,
		:fundacao,
		:estrutura,
		:acabamento,
		:paralisada,
		:concluida,
		:proprietario1,
		:proprierario2,
		:proprietario3,
		:proprietario4,
		:investidor1,
		:investidor2,
		:investidor3,
		:investidor4,
		:construtora1_codigo,
		:construtora1_razao_social,
		:construtora2_codigo,
		:construtora2_razao_social,
		:construtora3_codigo,
		:construtora3_razao_social,
		:construtora4_codigo,
		:construtora4_razao_social,
		:tipo_de_obra,
		:tipo_de_obra_outros,
		:teve_consultoria,
		:teve_consultoria_qual_empresa,
		:ficha_tecnica_observacao,
		:sistema_leed,
		:sistema_aqua,
		:sistema_procel_edifica,
		:sistema_qualiverde,
		:sistema_bream,
		:sistema_dgnb,
		:sistema_lbc,
		:sistema_outros,
		:leed_nc,
		:leed_cs,
		:leed_ci,
		:leed_eb,
		:aqua_bairros,
		:aqua_edificios,
		:aqua_servicos,
		:aqua_operacao_e_uso,
		:procel_residencial,
		:procel_comercial,
		:tipo_de_sistema_outros,
		:versao_do_sistema,
		:perfil_nivel_de_certificacao,
		:perfil_nivel_de_certificacao_outros,
		:vagas_verdes,
		:vagas_verdes_quantidade,
		:estacoes_de_recarga_de_veiculos_eletricos,
		:estacoes_de_recarga_de_veiculos_eletricos_quantidade,
		:bicicletarios,
		:bicicletarios_quantidade,
		:vestiarios_com_chuveiro,
		:vestiarios_com_chuveiro_quantidade,
		:proximidade_ao_tpublico_metro,
		:proximidade_ao_tpublico_metro_distancia_aproximada,
		:proximidade_ao_tpublico_trem,
		:proximidade_ao_tpublico_trem_distancia_aproximada,
		:proximidade_ao_tpublico_ponto_de_onibus,
		:proximidade_ao_tpublico_ponto_de_onibus_distancia_aproximada,
		:proximidade_ao_tpublico_outros,
		:proximidade_ao_tpublico_outros_distancia_aproximada,
		:como_esta_reduzindo_ilhas_de_calor_alta_refletancia,
		:como_esta_reduzindo_ilhas_de_calor_telhado_verde,
		:como_esta_reduzindo_ilhas_de_calor_vagas_cobertas,
		:como_esta_reduzindo_ilhas_de_calor_piso_concregama,
		:como_esta_reduzindo_ilhas_de_calor_outros,
		:bacias_e_mictorios_bacias_a_vacuo,
		:bacias_e_mictorios_bacias_dual_flux,
		:bacias_e_mictorios_het,
		:bacias_e_mictorios_mictorios_secos,
		:bacias_e_mictorios_mictorio_fechamento_hidromecanico,
		:bacias_e_mictorios_mictorio_fechamento_com_sensor_de_presenca,
		:torneiras_restritores_de_vazao,
		:torneiras_acionamento_hidromecanico,
		:torneiras_sensor_de_presenca,
		:torneiras_regulador_de_vazao,
		:torneiras_outros_enable,
		:torneiras_outros,
		:chuveiros,
		:irrigacao,
		:piscina,
		:torres_de_resfriamento,
		:torres_de_resfriamento_sim,
		:agua_pluvial,
		:agua_pluvial_para_irrigacao_do_paisagismo,
		:agua_pluvial_para_lavagem_de_pisos,
		:agua_pluvial_para_bacias,
		:agua_pluvial_outros,
		:vrf_tipo,
		:agua_de_lencol,
		:agua_de_lencol_para_irrigacao_do_paisagismo,
		:agua_de_lencol_para_lavagem_de_pisos,
		:agua_de_lencol_para_bacias,
		:agua_de_lencol_outros,
		:agua_condensacao_tratada,
		:agua_condensacao_tratada_para_irrigacao_do_paisagismo,
		:agua_condensacao_tratada_para_lavagem_de_pisos,
		:agua_condensacao_tratada_para_bacias,
		:agua_condensacao_tratada_outros,
		:agua_cinza_tratada,
		:agua_cinza_tratada_para_irrigacao_do_paisagismo,
		:agua_cinza_tratada_para_lavagem_de_pisos,
		:agua_cinza_tratada_para_bacias,
		:agua_cinza_tratada_outros,
		:agua_negra_tratada,
		:agua_negra_tratada_para_irrigacao_do_paisagismo,
		:agua_negra_tratada_para_lavagem_de_pisos,
		:agua_negra_tratada_para_bacias,
		:agua_negra_tratada_outros,
		:medicao_de_agua,
		:medicao_setorizada_de_consumos,
		:medicao_de_agua_outros,
		:drenagem_pisos_permeaveis,
		:drenagem_caixa_de_retardo,
		:drenagem_remocao_de_solidos_suspensos,
		:drenagem_captacao_e_aproveitamente_de_agua_pluvial,
		:drenagem_outros,
		:ar_condicionado_condensacao_vrf,
		:ar_condicionado_condensacao_central_de_agua_gelada,
		:ar_condicionado_condensacao_outros,
		:ar_condicionado_condensacao_bom,
		:central_de_agua_gelada,
		:tratamento_de_ar_externo_roda_entalpica,
		:tratamento_de_ar_externo_trocador_de_calor,
		:tratamento_de_ar_externo_controle_de_demanda_de_ventilacao_por_,
		:tratamento_de_ar_externo_outros,
		:tipo_de_insuflamento_de_ar_teto,
		:tipo_de_insuflamento_de_ar_piso,
		:tipo_de_insuflamento_de_ar_vigas_frias,
		:tipo_de_insuflamento_de_ar_outros,
		:eletrica_medicao_setorizada_de_consumo_de_energia,
		:eletrica_entrada_de_energia,
		:eletrica_fonte_de_energia,
		:entrada_de_energia,
		:eletrica_fonte_de_energia_eletrica,
		:eletrica_fonte_de_energia_gas,
		:eletrica_fonte_de_energia_outros,
		:medicao_de_energia,
		:energia_alternativa_solar_fotovoltaica,
		:energia_alternativa_aquecimento_solar_de_agua,
		:energia_alternativa_eolica,
		:energia_alternativa_biomassa,
		:energia_alternativa_outros,
		:iluminacao_lampadas_t5,
		:iluminacao_lampadas_t5_area_privativa,
		:iluminacao_lampadas_t5_area_comum,
		:iluminacao_lampadas_led,
		:iluminacao_integracao_da_iluminacao_com_a_iluminacao_natural,
		:iluminacao_dali,
		:iluminacao_sensores_de_presenca_em_areas_comuns,
		:iluminacao_controles_acionamento_automatizado,
		:iluminacao_fotocelulas_na_iluminacao_externa,
		:iluminacao_outros,
		:existe_area_envidracada_na_fachada,
		:tipos_de_protecoes_solares,
		:equipamentos_outros,
		:material_de_baixo_voc,
		:madeira_certificada,
		:pisos_e_carpetes_certificados,
		:coleta_de_residuos_reciclaveis_deposito_central,
		:coleta_de_residuos_reciclaveis_deposito_no_pavimento,
		:coleta_de_residuos_reciclaveis_outros,
		:coleta_de_residuos_reciclaveis_nivel_de_filtragem,
		:coleta_de_residuos_reciclaveis_nivel_de_filtragem_tipo,
		:coleta_de_residuos_reciclaveis_sistema_trat_ar_interno,
		:coleta_de_residuos_reciclaveis_nivel_filtragem,
		:sistema, 
		:sistema_outros_enable,
		:tipo_de_sistema_outros_enable,
		:proximidade_ao_tpublico_outros_enable,
		:bacias_e_mictorios_outros_enable,
		:bacias_e_mictorios_outros,
		:agua_pluvial_outros_enable,
		:agua_de_lencol_outros_enable,
		:agua_condensacao_tratada_outros_enable,
		:agua_cinza_tratada_outros_enable,
		:agua_negra_tratada_outros_enable,
		:ar_condicionado_outros_enable,
		:eletrica_fonte_de_energia_outros_enable,
		:eletrica_outros_enable,
		:eletrica_tipo_enable,
		:energia_alternativa_outros_enable,
		:iluminacao_outros_enable,
		:equipamentos_outros_enable,
		:como_esta_reduzindo_ilhas_de_calor_outros_enable,
		:drenagem_outros_enable,
		:tratamento_de_ar_externo_outros_enable,
		:variador_frequencia_outros_enable,
		:tipo_de_insuflamento_de_ar_outros_enable,
		:vidros_area_envidracada_outros_enable,
		:coleta_de_residuos_reciclaveis_outros_enable,
		:coleta_de_residuos_reciclaveis_nivel_filtragem_enable,
		:perfil_nivel_de_certificacao_categoria_n_1_relacao_do_edificio_co,
		:perfil_nivel_de_certificacao_categoria_n_2_escolha_integrada_de_p,
		:perfil_nivel_de_certificacao_categoria_n_3_canteiro_de_obras_com_,
		:perfil_nivel_de_certificacao_categoria_n_4_gestao_da_energia,
		:perfil_nivel_de_certificacao_categoria_n_5_gestao_da_agua,
		:perfil_nivel_de_certificacao_categoria_n_6_gestao_dos_residuos_de,
		:perfil_nivel_de_certificacao_categoria_n_7_manutencao_permanencia,
		:perfil_nivel_de_certificacao_categoria_n_8_conforto_higrotermico,
		:perfil_nivel_de_certificacao_categoria_n_9_conforto_acustico,
		:perfil_nivel_de_certificacao_categoria_n_10_conforto_visual,
		:perfil_nivel_de_certificacao_categoria_n_11_conforto_olfativo,
		:perfil_nivel_de_certificacao_categoria_n_12_qualidade_sanitaria_d,
		:perfil_nivel_de_certificacao_categoria_n_13_qualidade_sanitaria_d,
		:perfil_nivel_de_certificacao_categoria_n_14_qualidade_sanitaria_d,
		:perfil_nivel_de_certificacao_enable_categoria_n_1_relacao_do_edif,
		:perfil_nivel_de_certificacao_enable_categoria_n_2_escolha_integra,
		:perfil_nivel_de_certificacao_enable_categoria_n_3_canteiro_de_obr,
		:perfil_nivel_de_certificacao_enable_categoria_n_4_gestao_da_energ,
		:perfil_nivel_de_certificacao_enable_categoria_n_5_gestao_da_agua,
		:perfil_nivel_de_certificacao_enable_categoria_n_6_gestao_dos_resi,
		:perfil_nivel_de_certificacao_enable_categoria_n_7_manutencao_perm,
		:perfil_nivel_de_certificacao_enable_categoria_n_8_conforto_higrot,
		:perfil_nivel_de_certificacao_enable_categoria_n_9_conforto_acusti,
		:perfil_nivel_de_certificacao_enable_categoria_n_10_conforto_visua,
		:perfil_nivel_de_certificacao_enable_categoria_n_11_conforto_olfat,
		:perfil_nivel_de_certificacao_enable_categoria_n_12_qualidade_sani,
		:perfil_nivel_de_certificacao_enable_categoria_n_13_qualidade_sani,
		:perfil_nivel_de_certificacao_enable_categoria_n_14_qualidade_sani,
		:perfil_nivel_de_certificacao_enable_categoria_n_1_relacao_do_ed,
		:perfil_nivel_de_certificacao_categoria_n_1_relacao_do_edificio_,
		:perfil_nivel_de_certificacao_enable_categoria_n_2_escolha_integ,
		:perfil_nivel_de_certificacao_categoria_n_2_escolha_integrada_de,
		:perfil_nivel_de_certificacao_enable_categoria_n_3_canteiro_de_o,
		:perfil_nivel_de_certificacao_categoria_n_3_canteiro_de_obras_co,
		:perfil_nivel_de_certificacao_enable_categoria_n_4_gestao_da_ene,
		:perfil_nivel_de_certificacao_enable_categoria_n_5_gestao_da_agu,
		:perfil_nivel_de_certificacao_enable_categoria_n_6_gestao_dos_re,
		:perfil_nivel_de_certificacao_categoria_n_6_gestao_dos_residuos_,
		:perfil_nivel_de_certificacao_enable_categoria_n_7_manutencao_pe,
		:perfil_nivel_de_certificacao_categoria_n_7_manutencao_permanenc,
		:perfil_nivel_de_certificacao_enable_categoria_n_8_conforto_higr,
		:perfil_nivel_de_certificacao_categoria_n_8_conforto_higrotermic,
		:perfil_nivel_de_certificacao_enable_categoria_n_9_conforto_acus,
		:perfil_nivel_de_certificacao_enable_categoria_n_10_conforto_vis,
		:perfil_nivel_de_certificacao_enable_categoria_n_11_conforto_olf,
		:perfil_nivel_de_certificacao_enable_categoria_n_12_qualidade_sa,
		:perfil_nivel_de_certificacao_categoria_n_12_qualidade_sanitaria,
		:perfil_nivel_de_certificacao_enable_categoria_n_13_qualidade_sa,
		:perfil_nivel_de_certificacao_categoria_n_13_qualidade_sanitaria,
		:perfil_nivel_de_certificacao_enable_categoria_n_14_qualidade_sa,
		:perfil_nivel_de_certificacao_categoria_n_14_qualidade_sanitaria,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_medicao_se,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_entrada_de,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_fonte_de_e,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_geracao,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_cogeracao,
		:equipamentos_motores_de_alta_eficiencia,
		:equipamentos_elevadores,
		:equipamentos_variadores_de_frequencia,
		:nos_ventiladores_de_tomadas_de_ar_externos,
		:nas_bombas_de_agua_gelada,
		:nas_torres_de_resfriamento,
		:nos_fan_coils,
		:nos_chillers,
		:ar_condicionado_condensacao_superior,
		:ar_condicionado_condensacao_excelente,
		:ar_condicionado_condensacao_chiller_de_absorcao,
		:existe_area_envidracada_na_fachada_outros,
		:medicao_de_energia_outros,
		:existe_area_envidracada_na_fachada_sim_outros,
		:medicao_de_energia_medicao_setorizada_de_consumo_outros,
		:existe_area_envidracada_na_fachada_sim_outros_quais,
		:medicao_de_energia_medicao_setorizada_de_consumo_outros_quais,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_eletrica,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_gas,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_peak_shavi,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_possui_100,
		:equipamentos_nos_ventiladores_de_tomadas_de_ar_externos,
		:equipamentos_nas_bombas_de_agua_gelada,
		:equipamentos_nas_torres_de_resfriamento,
		:equipamentos_nos_fan_coils,
		:equipamentos_nos_chillers,
		:existe_area_envidracada_na_fachada_insulado,
		:existe_area_envidracada_na_fachada_laminado,
		:existe_area_envidracada_na_fachada_low_e_baixa_emissividade,
		:medicao_de_energia_elevadores,
		:medicao_de_energia_ar_condicionado,
		:medicao_de_energia_ventilacao,
		:medicao_de_energia_iluminacao,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_geracao_pe,
		:eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_geracao_po,
		:equipamentos_variadores_de_frequencia_nos_ventiladores_de_tomad,
		:equipamentos_variadores_de_frequencia_nas_bombas_de_agua_gelada,
		:equipamentos_variadores_de_frequencia_nas_torres_de_resfriament,
		:equipamentos_variadores_de_frequencia_nos_fan_coils,
		:equipamentos_variadores_de_frequencia_nos_chillers,
		:equipamentos_variadores_de_frequencia_outros,
		:ar_condicionado_condensacao_enable_chiller_eletrico,
		:ar_condicionado_condensacao_central_de_agua_gelada_chiller_elet,
		:outros_eletrica_tamanho_da_entrada_tipo_de_fonte_de_energia_fon,
		:outros_equipamentos_variadores_de_frequencia,
		:eletrica_geracao,
		:eletrica_cogeracao,
		:eletrica_outros,
		:eletrica_geracao_peak_shaving,
		:eletrica_geracao_possui_100_de_backup,
	]

	store :dados, accessors: COLUNAS
	attr_accessor :passo, :proximo_passo

	validates :nome_da_obra, presence: true
	validates :codigo_obra, presence: true

	def self.to_csv(options={})
		CSV.generate(options) do |csv|
			@colunas = COLUNAS.map{|c| c.to_s}
			csv << @colunas
			all.each do |item|
				csv << item.dados.values_at(*@colunas).map do |v|
					v = case v
						when "1" then "Sim"
						when "0" then "Não"
						else v
					end
				end
			end
		end
	end

end
